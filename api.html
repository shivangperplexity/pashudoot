<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Documentation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #c3d9bc, #dff2e1, #a3c9a8);
            background-attachment: fixed;
            overflow-x: hidden;
            color: #4a5568;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }
        .glass-container {
            backdrop-filter: blur(25px);
            background-color: rgba(255, 255, 255, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 40px 0 rgba(255, 255, 255, 0.5);
        }
        .drawer-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
            z-index: 40;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        .drawer-overlay.open { opacity: 1; visibility: visible; }
        .drawer {
            position: fixed;
            top: 0;
            right: -100%;
            width: 80%;
            max-width: 300px;
            height: 100%;
            padding: 2rem;
            z-index: 50;
            transition: right 0.3s ease-in-out;
        }
        .drawer.open { right: 0; }
        .code-block {
            background-color: #f1f5f9;
            border-radius: 0.5rem;
            padding: 1rem;
            overflow-x: auto;
            position: relative;
        }
        .code-block code {
            font-family: monospace;
            font-size: 0.875rem;
            line-height: 1.5;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .code-copy-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background-color: #cbd5e1;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .code-copy-btn:hover {
            background-color: #94a3b8;
        }
        .logo-circle {
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid #a3c9a8;
        }
    </style>
</head>
<body class="text-gray-700">
    <button id="hamburger-btn" class="fixed top-4 right-4 z-50 p-2 glass-container rounded-full shadow-lg">
        <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
        </svg>
    </button>

    <div id="drawer-overlay" class="drawer-overlay"></div>
    <div id="drawer" class="drawer glass-container shadow-xl">
        <div class="flex justify-end">
            <button id="drawer-close-btn" class="p-2 text-gray-600 hover:text-gray-800 transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
        <nav class="flex flex-col gap-4 mt-8">
            <a href="index.html" class="py-2 px-4 rounded-lg font-semibold text-gray-700 hover:bg-white/50 transition-colors">Home</a>
            <a href="live_camera.html" class="py-2 px-4 rounded-lg font-semibold text-gray-700 hover:bg-white/50 transition-colors">Detect from Live Camera</a>
            <a href="about.html" class="py-2 px-4 rounded-lg font-semibold text-gray-700 hover:bg-white/50 transition-colors">About</a>
            <a href="developers.html" class="py-2 px-4 rounded-lg font-semibold text-gray-700 hover:bg-white/50 transition-colors">Developers</a>
            <a href="api.html" class="py-2 px-4 rounded-lg font-semibold text-gray-700 hover:bg-white/50 transition-colors">API Documentation</a>
        </nav>
    </div>

    <main class="glass-container rounded-3xl p-6 md:p-10 w-full max-w-4xl shadow-lg">
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold mb-2 text-gray-800">API Documentation</h1>
            <p class="text-gray-600 max-w-2xl mx-auto">
                Pashu Mitra uses two in-house developed deep learning models hosted on Hugging Face to perform its detection and classification tasks. The API is designed to be simple and easy to integrate into any application.
            </p>
        </div>

        <div class="glass-container rounded-2xl p-6 mb-8">
            <div class="flex items-center gap-4 mb-4">
                <img src="cl.png" alt="CattleLense Logo" class="w-16 h-16 logo-circle">
                <h2 class="text-2xl md:text-3xl font-bold text-gray-800">1. CattleLense (Detection)</h2>
            </div>
            <p class="text-gray-600 mb-4">
                This model acts as a preliminary filter, an image classifier that determines if an image contains a cattle, buffalo, or goat. This ensures that the more specific breed classification model is only called on relevant images, improving efficiency and accuracy.
            </p>
            
            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-800">Endpoint</h3>
                <div class="code-block">
                    <button class="code-copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>https://sih20254-cattle-lens.hf.space/predict</code>
                </div>
            </div>

            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-800">Method</h3>
                <div class="code-block">
                    <button class="code-copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>POST</code>
                </div>
            </div>

            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-800">Request</h3>
                <p class="text-sm text-gray-600 mb-2">Send a <code>FormData</code> object with the image file.</p>
                <div class="code-block">
                    <button class="code-copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>
file: <input type="file" name="file">
                    </code>
                </div>
            </div>

            <div>
                <h3 class="text-lg font-semibold text-gray-800">Response</h3>
                <p class="text-sm text-gray-600 mb-2">Returns a JSON object with the prediction label.</p>
                <div class="code-block">
                    <button class="code-copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>
{
  "prediction": "LABEL_1"  // "LABEL_1" for cattle detected, "LABEL_0" otherwise
}
                    </code>
                </div>
            </div>
        </div>

        <div class="glass-container rounded-2xl p-6">
            <div class="flex items-center gap-4 mb-4">
                <img src="creto.png" alt="Creto.ai Logo" class="w-16 h-16 logo-circle">
                <h2 class="text-2xl md:text-3xl font-bold text-gray-800">2. Creto.ai (Classification)</h2>
            </div>
            <p class="text-gray-600 mb-4">
                This model classifies the breed of the animal if it has been detected by the CattleLense model. It can identify over 15 common cow, buffalo, and goat breeds found in India.
            </p>
            
            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-800">Endpoint</h3>
                <div class="code-block">
                    <button class="code-copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>https://Shivangguptasih-Creto-ai.hf.space/predict</code>
                </div>
            </div>

            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-800">Method</h3>
                <div class="code-block">
                    <button class="code-copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>POST</code>
                </div>
            </div>

            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-800">Request</h3>
                <p class="text-sm text-gray-600 mb-2">Send a <code>FormData</code> object with the image file.</p>
                <div class="code-block">
                    <button class="code-copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>
file: <input type="file" name="file">
                    </code>
                </div>
            </div>

            <div>
                <h3 class="text-lg font-semibold text-gray-800">Response</h3>
                <p class="text-sm text-gray-600 mb-2">Returns a JSON object with the predicted breed name.</p>
                <div class="code-block">
                    <button class="code-copy-btn" onclick="copyCode(this)">Copy</button>
                    <code>
{
  "prediction_index": 5,
  "prediction": "deoni",
  "score": 0.998765
}
                    </code>
                </div>
            </div>
        </div>

        <div class="glass-container rounded-2xl p-6 mt-8">
            <h2 class="text-2xl md:text-3xl font-bold mb-4 text-gray-800 text-center">Example Usage (JavaScript)</h2>
            <p class="text-gray-600 mb-4">
                Here's how you can chain the two APIs to first detect an animal and then classify its breed.
            </p>
            <div class="code-block">
                <button class="code-copy-btn" onclick="copyCode(this)">Copy</button>
                <code>
async function predictBreed(file) {
    // Step 1: Detect if the image contains a cattle
    const detectFormData = new FormData();
    detectFormData.append("file", file);
    const detectResp = await fetch("https://sih20254-cattle-lens.hf.space/predict", { method: "POST", body: detectFormData });
    const detectData = await detectResp.json();
    const isCattleDetected = detectData?.prediction === "LABEL_1";

    if (!isCattleDetected) {
        return "No cattle detected.";
    }

    // Step 2: If cattle is detected, classify the breed
    const breedFormData = new FormData();
    breedFormData.append("file", file);
    const breedResp = await fetch("https://Shivangguptasih-Creto-ai.hf.space/predict", { method: "POST", body: breedFormData });
    const breedData = await breedResp.json();
    let breedLabel = breedData?.prediction ? breedData.prediction.toLowerCase() : "Not Identified";

    // Optional: Format the breed name
    const formattedBreed = breedLabel.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
    return formattedBreed;
}
                </code>
            </div>
        </div>
    </main>

    <script>
        const hamburgerBtn = document.getElementById('hamburger-btn');
        const drawer = document.getElementById('drawer');
        const drawerOverlay = document.getElementById('drawer-overlay');
        const drawerCloseBtn = document.getElementById('drawer-close-btn');

        hamburgerBtn.addEventListener('click', () => {
            drawer.classList.add('open');
            drawerOverlay.classList.add('open');
        });
        drawerCloseBtn.addEventListener('click', () => {
            drawer.classList.remove('open');
            drawerOverlay.classList.remove('open');
        });
        drawerOverlay.addEventListener('click', () => {
            drawer.classList.remove('open');
            drawerOverlay.classList.remove('open');
        });

        function copyCode(button) {
            const codeBlock = button.parentElement;
            const code = codeBlock.querySelector('code').innerText;
            navigator.clipboard.writeText(code).then(() => {
                button.textContent = 'Copied!';
                setTimeout(() => {
                    button.textContent = 'Copy';
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy text: ', err);
            });
        }
    </script>
</body>
</html>
