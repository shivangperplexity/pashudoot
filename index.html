<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cattle Breed Identifier</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body {
    min-height: 100vh;
    background: linear-gradient(135deg, #fde2e4, #e2f0cb, #cddafd);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
    font-family: 'Inter', sans-serif;
    margin: 0;
}
h1 { font-size: 2rem; margin-bottom: 20px; font-weight: 700; color: #6a1b9a; text-align: center; }
.upload-container {
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 90%;
    max-width: 340px;
    height: 200px;
    background: rgba(255, 255, 255, 0.6);
    border: 2px dashed #6a1b9a;
    border-radius: 16px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.upload-container:hover, .upload-container.dragover {
    transform: scale(1.03);
    box-shadow: 0 8px 16px rgba(106, 27, 154, 0.3);
    background: rgba(255,255,255,0.8);
}
.upload-icon { width: 40px; height: 40px; margin-bottom: 8px; stroke: #6a1b9a; }
.upload-text { color: #333; font-size: 1rem; font-weight: 600; }
input[type="file"] { display: none; }

.overlay {
    position: fixed;
    inset: 0;
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(4px);
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    text-align: center;
    padding: 20px;
}
.overlay.visible { display: flex; }
.overlay img { transform: scale(2); margin-bottom: 20px; }

.progress-texts p {
    font-size: 1.2rem;
    font-weight: 600;
    opacity: 0;
    transition: opacity 0.5s ease;
    display: flex;
    align-items: center;
    gap: 6px;
}
.dot-container { display: inline-flex; gap: 2px; }
.dot { width: 6px; height: 6px; background:#6a1b9a; border-radius:50%; animation: bounce 1s infinite; }
.dot:nth-child(2){animation-delay:0.2s;}
.dot:nth-child(3){animation-delay:0.4s;}
@keyframes bounce {0%,100%{transform:translateY(0);}50%{transform:translateY(-6px);}}

.result { margin-top: 20px; max-width: 500px; width: 100%; background: #fff; padding: 0; border-radius: 16px; box-shadow: 0 6px 16px rgba(106, 27, 154, 0.25); opacity: 0; transform: translateY(20px); transition: opacity 0.6s ease, transform 0.6s ease; overflow: hidden; }
.result.visible { opacity: 1; transform: translateY(0); }
.result-header { background: linear-gradient(135deg, #6a1b9a, #d81b60); padding: 12px; text-align: center; color: #fff; font-weight: 700; font-size: 1.4rem; }
.result-body { padding: 16px 20px; }
.result-body p { font-size: 1rem; margin: 10px 0; font-weight: 500; color: #333; }
.result-body strong { color: #6a1b9a; font-weight: 700; }

.debug { display: none; }
</style>
</head>
<body>
<h1>Cattle Breed Identifier</h1>

<label class="upload-container" id="dropArea">
<svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke-width="2">
<path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
</svg>
<span class="upload-text">Upload Image</span>
<input type="file" accept="image/*" id="imageUpload">
</label>

<div id="overlay" class="overlay">
<img src="analyze.gif" alt="Loading...">
<div class="progress-texts">
<p id="stepText">Uploading Image<span class="dot-container"><span class="dot"></span><span class="dot"></span><span class="dot"></span></span></p>
</div>
</div>

<div id="result" class="result">
<div id="header" class="result-header"></div>
<div class="result-body">
<p id="origin"></p>
<p id="lifespan"></p>
<p id="milkYield"></p>
<p id="description"></p>
</div>
</div>

<input type="file" id="imageUploadHidden" style="display:none">

<script>
const overlay=document.getElementById("overlay");
const stepText=document.getElementById("stepText");
const result=document.getElementById("result");
const header=document.getElementById("header");
const origin=document.getElementById("origin");
const lifespan=document.getElementById("lifespan");
const milkYield=document.getElementById("milkYield");
const description=document.getElementById("description");
const dropArea=document.getElementById("dropArea");
const fileInput=document.getElementById("imageUpload");

const breedInfo={
"Barbari Goat":{origin:"Rajasthan, India",lifespan:"10-12 years",milkYield:"1-2 L/day",description:"Small-sized dual-purpose goat."},
"Bargur Cow":{origin:"Tamil Nadu, India",lifespan:"15-18 years",milkYield:"3-5 L/day",description:"Draught cattle from hilly areas."},
"Bhadawari Buffalo":{origin:"U.P., India",lifespan:"16-20 years",milkYield:"6-10 L/day",description:"Milk with high fat content."},
"Black Bengal Goat":{origin:"West Bengal, India",lifespan:"8-12 years",milkYield:"1-2 L/day",description:"Known for meat and skin quality."},
"Hallikar Cow":{origin:"Karnataka, India",lifespan:"15-20 years",milkYield:"2-5 L/day",description:"Strong draught breed."},
"Hariana Cow":{origin:"Haryana, India",lifespan:"16-20 years",milkYield:"6-10 L/day",description:"Dairy breed with high milk yield."},
"Holstein Friesian Cow":{origin:"Netherlands",lifespan:"18-22 years",milkYield:"20-30 L/day",description:"World's leading dairy breed."},
"Jamunapari Goat":{origin:"U.P., India",lifespan:"10-12 years",milkYield:"2-3 L/day",description:"Large goat with high milk yield."},
"Nagori Goat":{origin:"Rajasthan, India",lifespan:"12-15 years",milkYield:"1-2 L/day",description:"Good draught goat breed."},
"Osmanabadi Goat":{origin:"Maharashtra, India",lifespan:"10-12 years",milkYield:"1-2 L/day",description:"Hardy and disease-resistant goat."},
"Tharparkar Cow":{origin:"Rajasthan, India",lifespan:"15-18 years",milkYield:"10-12 L/day",description:"Dual-purpose heat-tolerant cow."},
"Deoni Cow":{origin:"Maharashtra/Karnataka/Andhra Pradesh",lifespan:"12-15 years",milkYield:"3-8 L/day",description:"Dual-purpose cow breed."},
"Gir Cow":{origin:"Gujarat, India",lifespan:"12-15 years",milkYield:"10-15 L/day",description:"High-quality A2 milk producer."},
"Guzerat Cow":{origin:"Gujarat, India",lifespan:"15-18 years",milkYield:"6-10 L/day",description:"Draught and dairy breed."},
"Jaffrabadi Buffalo":{origin:"Gujarat, India",lifespan:"14-18 years",milkYield:"6-10 L/day",description:"Large buffalo, high milk yield."},
"Jersey Cow":{origin:"Jersey Island, UK",lifespan:"18-22 years",milkYield:"12-20 L/day",description:"Rich milk producer."},
"Mehsana Buffalo":{origin:"Gujarat, India",lifespan:"16-20 years",milkYield:"8-12 L/day",description:"Good dairy buffalo."},
"Murrah Buffalo":{origin:"Haryana, India",lifespan:"16-20 years",milkYield:"8-12 L/day",description:"High milk-producing buffalo."},
"Nili Ravi Buffalo":{origin:"Pakistan",lifespan:"14-18 years",milkYield:"7-12 L/day",description:"Famous dairy buffalo breed."},
"Pandharpuri Cow":{origin:"Maharashtra, India",lifespan:"12-15 years",milkYield:"5-8 L/day",description:"Adapted to drought regions."},
"Rathi Cow":{origin:"Rajasthan, India",lifespan:"15-20 years",milkYield:"8-10 L/day",description:"Heat-tolerant dairy cow."},
"Red Sindhi Cow":{origin:"Sindh (Pakistan/India)",lifespan:"12-15 years",milkYield:"8-12 L/day",description:"Good milk yield, heat-tolerant."},
"Sahiwal Cow":{origin:"Punjab region",lifespan:"12-15 years",milkYield:"12-18 L/day",description:"Heat-tolerant dairy breed."},
"Sirohi Cow":{origin:"Rajasthan, India",lifespan:"10-12 years",milkYield:"1-2 L/day",description:"Good meat and milk producer."},
"Vechur Cow":{origin:"Kerala, India",lifespan:"15-18 years",milkYield:"2-3 L/day",description:"Smallest cow breed, hardy."},
"Not Identified":{origin:"-",lifespan:"-",milkYield:"-",description:"Breed could not be identified."}
};

const stepsArr=["Uploading Image","Running Model","Analyzing","Fetching Results"];

async function runStepsSingle(){
    for(let text of stepsArr){
        stepText.style.opacity=0;
        await new Promise(r=>setTimeout(r,300));
        stepText.childNodes[0].textContent=text;
        stepText.style.opacity=1;
        await new Promise(r=>setTimeout(r,1200));
    }
}

async function handleFile(file){
    overlay.classList.add("visible");
    result.classList.remove("visible");
    header.textContent="";
    origin.textContent=lifespan.textContent=milkYield.textContent=description.textContent="";
    await runStepsSingle();

    try{
        const formData=new FormData();
        formData.append("file",file);
        const detectResp=await fetch("https://rjsmoke00-cd.hf.space/predict",{method:"POST",body:formData});
        let detectData=await detectResp.json();
        let detectLabel=(detectData && detectData.prediction)?detectData.prediction:"Not Identified";

        if(detectLabel==="LABEL_0") detectLabel="Not Identified";
        else if(detectLabel==="LABEL_1") detectLabel="Detected";

        if(detectLabel==="Detected"){
            const breedForm=new FormData();
            breedForm.append("file",file);
            try{
                const breedResp=await fetch("https://Shivangguptasih-v2.hf.space/predict",{method:"POST",body:breedForm});
                const breedData=await breedResp.json();
                if(breedData && breedData.prediction) detectLabel=breedData.prediction;
                else detectLabel="Not Identified";
            }catch(e){ detectLabel="Not Identified"; }
        }

        const info=breedInfo[detectLabel]||breedInfo["Not Identified"];
        if(detectLabel==="Not Identified"){
            header.textContent="ðŸš« No Cattle Detected";
            origin.textContent=lifespan.textContent=milkYield.textContent=description.textContent="";
        } else {
            header.textContent="âœ… Cattle Detected â†’ Breed: "+detectLabel;
            origin.innerHTML=`<strong>Origin:</strong> ${info.origin}`;
            lifespan.innerHTML=`<strong>Lifespan:</strong> ${info.lifespan}`;
            milkYield.innerHTML=`<strong>Milk Yield:</strong> ${info.milkYield}`;
            description.innerHTML=`<strong>Description:</strong> ${info.description}`;
        }
    }catch(err){
        header.textContent="âš ï¸ Error analyzing image";
        console.error(err);
    }finally{
        overlay.classList.remove("visible");
        result.classList.add("visible");
    }
}

fileInput.addEventListener("change",(e)=>{
    const file=e.target.files[0];
    if(file) handleFile(file);
});

dropArea.addEventListener("dragover",(e)=>{ e.preventDefault(); dropArea.classList.add("dragover"); });
dropArea.addEventListener("dragleave",()=>dropArea.classList.remove("dragover"));
dropArea.addEventListener("drop",(e)=>{
    e.preventDefault();
    dropArea.classList.remove("dragover");
    const file=e.dataTransfer.files && e.dataTransfer.files[0];
    if(file) handleFile(file);
});
</script>
</body>
</html>
